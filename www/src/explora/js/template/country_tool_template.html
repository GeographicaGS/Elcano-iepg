<%
    
    variable = model ? model.family.global : null;
    console.log(model);
    gdp = model ? model.context.gdp : null;
    population = model ? model.context.population : null;
    country = ctx.countries.selection.length ? ctx.countries.selection[0] : null;
    country_str = country ? app.countryToString(country) :  "<lang>Seleccione un país</lang>";
    year = ctx.slider[0].date.getFullYear();
%>

<div id="country_tool" >
    <div class="header" data-variable=<%=ctx.family%>>
        <a class="close" href="#"></a>
        <span id="tool_name"><lang>Ficha país</lang></span>
        <span id="tool_year"><lang>Año</lang> <%= year %></span>

        <select id="ctrl_family">
            <option value="iepg" <%= ctx.family == "iepg" ? "selected" : "" %>><lang>Presencia Global</lang></option>
            <option value="iepe" <%= ctx.family == "iepe" ? "selected" : "" %> ><lang>Presencia Europea</lang></option>
        </select>
    </div>

    <% if (model && variable.value) { %>
    <div class="body">
        <a href="#" class="helpIcon">
            <img src="/img/ELC_icon_info_popover.svg" width="16px" height="16px" />
        </a>
        <div class="container-fluid">
            <div class="row mth1">

                <div class="col-sm-6 col-md-6">
                    <div class="row">
                        <div class="col-sm-12">
                            <h5><%= app.variableToString("global",ctx.family) %></h5>
                            <h6><%= app.countryToString(country) %></h6>
                        </div>
                    </div>
                    <div class="row mth1">
                        <div class="col-sm-3 col-md-3">
                            <span class="grey uppercase size_11"><lang>Valor</lang></span>
                        </div>
                        <div class="col-sm-4 col-md-4" title="<%=  app.countryToString(country) %>">
                            <div class="co_flag" >
                                <img src="/img/flags/<%= country %>.svg" class="flag" />
                            </div>
                            <span class="grey size_21 fleft mt7 ml roboto_light" title="<%=  app.countryToString(country) %>">
                                <%= country.length == 2 ? country : country.substring(2) %>
                            </span>
                            <span class="grey size_21 fleft mt7 ml roboto_bold"><%= sprintf("%0.2f",variable.value) %></span>
                        </div>
                        <div class="col-sm-5 col-md-5 co_ranking">
                            <% if (country.length == 2) { %>
                                <span class="size_13">
                                    <%= sprintf("<lang> Puesto %dº</lang>", variable.globalranking) %>
                                </span>
                                <% if (app.getFilters().length && variable.relativeranking) { %>
                                    <span class="size_13 roboto_italic">(<%= sprintf("%dº", variable.relativeranking) %>)</span>
                                <% }%>
                            <% } else { %>
                                <span class="size_13">
                                    <%= sprintf("<lang> Puesto %dº</lang>", variable.relativeranking) %>
                                </span>
                            <% } %>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-xs-12">
                            <div class="sep"></div>
                        </div>
                    </div>

                     <% if (gdp.value) { %>
                    <div class="row ">
                        <div class="col-sm-3 col-md-3">
                            <span class="grey uppercase size_11"><lang>PIB</lang></span>
                        </div>
                        <div class="col-sm-4 col-md-4">
                            <span class="grey size_16"><%= parseInt(gdp.value).toLocaleString() %></span>
                            <span class="grey_light uppercase size_13">[US$]</span>
                        </div>
                        <div class="col-sm-5 col-md-5 co_ranking">
                            <% if (country.length == 2) { %>
                                <span class="size_13">
                                    <%= sprintf("<lang> Puesto %dº</lang>", gdp.globalranking) %>
                                </span>
                                <% if (app.getFilters().length && gdp.relativeranking) { %>
                                    <span class="size_13 roboto_italic">(<%= sprintf("%dº", gdp.relativeranking) %>)</span>
                                <% }%>
                            <% } else { %>
                                <span class="size_13">
                                    <%= sprintf("<lang> Puesto %dº</lang>", gdp.relativeranking) %>
                                </span>
                            <% } %>
                           
                        </div>
                    </div>
                  
                    <div class="row">
                        <div class="col-xs-12">
                            <div class="sep"></div>
                        </div>
                    </div>

                    <% } %>

                    <% if (population.value) { %>
                    <div class="row ">
                        <div class="col-sm-3 col-md-3">
                            <span class="grey uppercase size_11"><lang>Población</lang></span>
                            
                        </div>
                        <div class="col-sm-4 col-md-4">
                            <span class="grey size_16"><%= parseInt(population.value).toLocaleString() %></span>
                            <span class="grey_light uppercase size_13">[<lang>hab</lang>]</span>
                        </div>
                        <div class="col-sm-5 col-md-5 co_ranking">
                            
                            <% if (country.length == 2) { %>
                                <span class="size_13">
                                    <%= sprintf("<lang> Puesto %dº</lang>", population.globalranking) %>
                                </span>
                                <% if (app.getFilters().length && population.relativeranking) { %>
                                    <span class="size_13 roboto_italic">(<%= sprintf("%dº", population.relativeranking) %>)</span>
                                <% }%>
                            <% } else { %>
                                <span class="size_13">
                                    <%= sprintf("<lang> Puesto %dº</lang>", population.relativeranking) %>
                                </span>
                            <% } %>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-xs-12">
                            <div class="sep"></div>
                        </div>
                    </div>
                    
                    <% } %>
                   

                    <% if (model.comment && model.comment.comment) { %>
                    <div class="row">
                        <div class="col-xs-12">
                            <span class="grey uppercase size_11"><lang>Resumen</lang></span>
                        </div>

                        <div class="col-xs-12">
                            <p class="size_16"><%= model.comment.comment %></p>
                        </div>
                    </div>
                    <% } %>

                </div>

                <div class="col-sm-6 col-md-6">
                    <div class="chart"></div>
                    <div class="chart_legend">
                        
                    </div>
                </div>
            </div>
            
        </div>

    </div>

    <%} else if (model && !variable.value){ %>
        <div class="body">
            <a href="#" class="helpIcon">
                <img src="/img/ELC_icon_info_popover.svg" width="16px" height="16px" />
            </a>
            <div class="container-fluid">
                <div class="row mth1">
                    <p class="col-xs-12">
                        <lang>No hay datos disponibles con los parámetros seleccionados</lang>.
                    </p>
                <div>
            </div>
        </div>
    <% } else { %>
        <div class="body">
            <a href="#" class="helpIcon">
                <img src="/img/ELC_icon_info_popover.svg" width="16px" height="16px" />
            </a>
            <div class="container-fluid">
                <div class="row mth1">
                    <p class="col-xs-12">
                        <lang>Seleccione un país</lang>.
                    </p>
                <div>
            </div>
        </div>
    <% } %>


</div>